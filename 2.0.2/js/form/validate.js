!function(){"use strict";function e(e,t,i,r,n,a){t[e]&&(i.push(e),!0!==t[e]&&1!==t[e]||r.push(n+e+"/"+a))}function t(e,t,i,r,n){var a=r+t+"/"+n;require._fileExists(e.toUrl(a+".js"))&&i.push(a)}function i(e,t,r){var n;for(n in t)!t.hasOwnProperty(n)||e.hasOwnProperty(n)&&!r?"object"==typeof t[n]&&(!e[n]&&t[n]&&(e[n]={}),i(e[n],t[n],r)):e[n]=t[n]}var r=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("fb/i18n",["module"],function(n){var a=n.config?n.config():{};return{version:"2.0.4",load:function(n,o,f,s){s=s||{},s.locale&&(a.locale=s.locale);var l,c,d,u=r.exec(n),v=u[1],h=u[4],_=u[5],p=h.split("-"),m=[],b={},g="";if(u[5]?(v=u[1],l=v+_):(l=n,_=u[4],h=a.locale,h||(h=a.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),p=h.split("-")),s.isBuild){for(m.push(l),t(o,"root",m,v,_),c=0;c<p.length;c++)d=p[c],g+=(g?"-":"")+d,t(o,g,m,v,_);o(m,function(){f()})}else o([l],function(t){var r,n=[];for(e("root",t,n,m,v,_),c=0;c<p.length;c++)r=p[c],g+=(g?"-":"")+r,e(g,t,n,m,v,_);o(m,function(){var e,r,a;for(e=n.length-1;e>-1&&n[e];e--)a=n[e],r=t[a],!0!==r&&1!==r||(r=o(v+a+"/"+_)),i(b,r);f(b)})})}}})}(),define("fb/nls/forms",{root:{required:"This field is required",required_checkbox:"You need to select this option",pattern_miss:"Please provide a valid value",not_the_same:"Please provide the same value as before"}}),define("fb/form/field",["fb/jquery","fb/i18n!fb/nls/forms"],function(e,t){"use strict";function i(i){var r=[];this.init=function(){i.data("field",this),i.on("change blur",null,this,function(e){e.data.validate()}),i.on("keyup keydown",null,this,function(e){e.data._validate_field_after_interval(e)}),"select"===i.prop("tagName")&&i.on("keyup",function(){this.change&&this.change()})},this.validate=function(){var t=this._check_for_required_field(),n=this._check_for_pattern(),a=this._check_for_comparison(),o=this;if("required"!==i.attr("required")&&""===i.val())return!0;if(void 0==i.data("validate-url"))return t&&n&&a?(this.set_valid(i),!0):(this._set_invalid(r),!1);var f=e(i.parents("form").get(0)),s={};e.each(f.serializeArray(),function(e,t){s[t.name]=t.value||""});var l={name:i.attr("name"),value:i.val(),form:s};e.post(i.data("validate-url"),l,function(e){return e.errors?(o._set_invalid([e.errors[i.attr("name")].message]),!1):(o.set_valid(i),!0)})},this.focus=function(){i.focus()},this._check_for_required_field=function(){var e=!0;return"required"===i.attr("required")&&(""===i.val()||"checkbox"===i.attr("type")&&!0!==i.is(":checked"))&&(e=!1,"checkbox"===i.attr("type")?r.push(t.required_checkbox):r.push(t.required)),e},this._check_for_pattern=function(){var e=!0;if(i.attr("pattern")){!1===new RegExp(i.attr("pattern")).test(i.val())&&(e=!1,r.push(t.pattern_miss))}return e},this._check_for_comparison=function(){var n=!0;if(i.data("compare-with")){var a=e("#"+i.data("compare-with"));i.val()!==a.val()&&(n=!1,r.push(t.not_the_same))}return n},this._set_invalid=function(t){i.removeClass("fb-field-filled-ok"),i.addClass("fb-field-filled-error"),i.data("valid-status",!1);var r=i.closest(".fb-form-field-wrapper");if(r.removeClass("fb-field-ok"),r.addClass("fb-field-error"),"yes"!==i.data("hide-messages")){var n,a=i.next();a.hasClass("fb-form-error")?(a.text(""),n=a):n=e("<div>").addClass("fb-form-error"),n.text(t[0]),i.after(n)}},this.set_valid=function(){i.removeClass("fb-field-filled-error"),i.addClass("fb-field-filled-ok"),i.data("valid",!0);var t=i.closest(".fb-form-field-wrapper");t.removeClass("fb-field-error"),t.addClass("fb-field-ok"),t.find("input,select").each(function(t,i){var r=e(i),n=r.closest(".fb-form-field-wrapper");!0!==r.data("valid")&&(n.removeClass("fb-field-ok"),n.addClass("fb-field-error"))});var r=i.next();r.hasClass("fb-form-error")&&r.remove()},this._done_typing_trigger=function(){var t=e(":focus"),i=t.data("field");""!==t.val()&&i&&i.validate()},this._validate_field_after_interval=function(e){"keydown"===e.type&&clearTimeout(e.data.done_typing_trigger),"keyup"===e.type&&(clearTimeout(e.data.done_typing_trigger),e.data.done_typing_trigger=setTimeout(this._done_typing_trigger,500))},this.get_element=function(){return i[0]},this.init()}return i}),define("fb/form/step",["fb/jquery","fb/form/field"],function(e,t){"use strict";function i(i,r){var n=[];this.init=function(){r.find("input, select").each(function(i,r){var a=new t(e(r));n.push(a)}),r.data("Step",this)},this.get_fields=function(){return n},this.validate=function(){var t=!0;return e(n).each(function(e,i){!1===i.validate()&&(t=!1)}),t},this.get_first_invalid_field=function(){var t=null;return e(n).each(function(e,i){if(!1===i.validate())return t=i,!1}),t},this.activate=function(){r.show()},this.deactivate=function(){r.hide()},this.init()}return i}),define("fb/form/progress",["fb/jquery","fb/form/step"],function(e,t){"use strict";var i,r=e([]),n=[],a=0,o=function(){l(a+1)},f=function(){l(a-1)},s=function(){return n[a]},l=function(t){r.removeClass("fb-process-step-active"),e(r[t]).addClass("fb-process-step-active"),n[a].deactivate(),n[t].activate(),a=t},c=function(a,o){i=o&&o.container?e(o.container).addBack().find(".fb-process"):e(".fb-process"),r=i.find(".fb-process-step"),a.find("fieldset").each(function(i){var r=new t(i,e(this));n.push(r)}),r.length,n.length,l(0)},d=function(t){e(n).each(function(i,r){e(r.get_fields()).each(function(e,r){if(r.get_element()===t)return l(i),r.focus(),!1})})};return{init:c,to_step:l,current_step:s,to_next_step:o,to_previous_step:f,focus_first_invalid_field:function(){var t=null;return e(n).each(function(e,i){var r=i.get_first_invalid_field();if(null!==r)return l(e),r.focus(),t=r,!1}),t},focus_on_field:d,validate:function(){var t=!0;return e(n).each(function(e,i){!0!==i.validate()&&(t=!1)}),t}}}),define("fb/form/validate",["fb/jquery","fb/form/progress"],function(e,t){"use strict";var i,r=function(e){t.to_step(e)},n=function(e){e.preventDefault(),!0===t.current_step().validate()&&t.to_next_step()},a=function(e){e.preventDefault(),t.to_previous_step()},o=function(n){if(n.preventDefault(),!0!==t.validate())return t.focus_first_invalid_field(),!1;e.ajax({url:i.attr("action"),type:i.attr("method")||"POST",data:i.serialize()}).done(function(n){switch(n.status){case"html":i.html(n.html);break;case"redirect":window.location.href=n.redirect;break;case"injection":if(n.injections)for(var a=0;a<n.injections.length;a++){var o=i.find(".injection_"+n.injections[a].fieldname);o.html(n.injections[a].html)}case"error":if(n.errors)for(var a=0;a<n.errors.length;a++){var f=n.errors[a],o=i.find("input[name='"+f.fieldname+"']")||i.find("select[name='"+f.fieldname+"']");o[0]&&(1==n.errors.length&&t.focus_on_field(o[0]),e(o[0]).data("field")._set_invalid([f.message]))}if(n.general){0===n.errors.length&&r(0);var s;s=e(".fb-application-failed").length>0?e(".fb-application-failed"):e("<div>").addClass("fb-application-failed");var l=s.text(n.general);i.before(l)}}})};return{init:function(r){i=r,t.init(i),i.attr("novalidate","novalidate"),i.find(".fb-form-next").on("click",n),i.find(".fb-btn--back").on("click",a),e(window).on("popstate",a),i.on("submit",o)}}});